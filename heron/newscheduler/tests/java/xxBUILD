load("/tools/rules/heron_deps", "heron_java_proto_files")

common_deps_files = \
    heron_java_proto_files() + [
        "//3rdparty/guava:guava-java",
        "//3rdparty/powermock:powermock-java",
        "@bazel_tools//third_party:junit4",
        "@bazel_tools//third_party:mockito",
    ]

java_test(
    name = "launch-runner_unittest",
    srcs = glob(
        ["**/service/LaunchRunnerTest.java"] +
        ["**/util/TopologyUtilityTest.java"]
    ),
    deps = [
        "//heron/api/src/java:api-java",
        "//heron/spi/src/java:scheduler-spi-java",
        "//heron/spi/src/java:statemgr-spi-java",
        "//heron/scheduler/src/java:scheduler-lib-java",
        "//heron/statemgrs/src/java:statemgrs-java",
        "//3rdparty/guava:guava-java",
        "@bazel_tools//third_party:mockito",
        "@bazel_tools//third_party:junit4",
    ] + heron_java_proto_files(),

    size = "small",
)

java_test(
    name = "scheduler-main_unittest",
    srcs = glob(["**/service/SchedulerMainTest.java"]),
    deps = [
        "//heron/api/src/java:api-java",
        "//heron/spi/src/java:scheduler-spi-java",
        "//heron/spi/src/java:statemgr-spi-java",
        "//heron/scheduler/src/java:scheduler-lib-java",
        "//heron/statemgrs/src/java:statemgrs-java",
        "//3rdparty/powermock:powermock-java",
        "@bazel_tools//third_party:mockito",
        "@bazel_tools//third_party:junit4",
    ] + heron_java_proto_files(),

    size = "small",
)

java_test(
    name = "submitter-main_unittest",
    srcs = glob(["**/service/SubmitterMainTest.java"]),
    deps = [
        "//heron/api/src/java:api-java",
        "//heron/spi/src/java:scheduler-spi-java",
        "//heron/spi/src/java:statemgr-spi-java",
        "//heron/scheduler/src/java:scheduler-lib-java",
        "//heron/statemgrs/src/java:statemgrs-java",
        "//3rdparty/powermock:powermock-java",
        "@bazel_tools//third_party:mockito",
        "@bazel_tools//third_party:junit4",
    ] + heron_java_proto_files(),

    size = "small",
)

java_test(
    name = "upload-runner_unittest",
    srcs = glob(
        ["**/service/UploadRunnerTest.java"] +
        ["**/util/TopologyUtilityTest.java"]
    ),
    deps = [
        "//heron/api/src/java:api-java",
        "//heron/scheduler/src/java:scheduler-lib-java",
        "//heron/spi/src/java:scheduler-spi-java",
        "@bazel_tools//third_party:mockito",
        "@bazel_tools//third_party:junit4",
    ] + heron_java_proto_files(),

    size = "small",
)

java_test(
    name = "scheduler-server_unittest",
    srcs = glob(
        ["**/service/server/SchedulerServerTest.java"] +
        ["**/util/TopologyUtilityTest.java"]
    ),
    deps = [
        "//heron/api/src/java:api-java",
        "//heron/spi/src/java:scheduler-spi-java",
        "//heron/scheduler/src/java:scheduler-lib-java",
        "//heron/statemgrs/src/java:statemgrs-java",
        "@bazel_tools//third_party:mockito",
        "@bazel_tools//third_party:junit4",
    ] + heron_java_proto_files(),

    size = "small",
)
